<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>JS照片瀑布流</title>
	<link rel="stylesheet" type="text/css" href="css/waterFall.css">
</head>
<body>
	<header>
		Beautiful southern girl
		<nav>
			<ul>
				<li><a href="JS实现瀑布流.html">JS</a></li>
				<li><a href="jQuery实现瀑布流.html">jQuery</a></li>
				<li><a href="jQuery实现瀑布流.html">CSS</a></li>			
			</ul>
		</nav>
	</header>
	<div id="main">
		<div class="box">
			<div class="pic">
				<img src="images/1.JPG">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="images/2.JPG">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="images/3.JPG">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="images/4.JPG">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="images/5.JPG">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="images/6.JPG">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="images/7.JPG">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="images/8.JPG">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="images/9.JPG">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="images/10.JPG">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="images/11.JPG">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="images/12.JPG">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="images/13.JPG">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="images/14.JPG">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="images/15.JPG">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="images/16.JPG">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="images/17.JPG">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="images/18.JPG">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="images/19.JPG">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="images/20.JPG">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="images/21.JPG">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="images/22.JPG">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="images/23.JPG">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="images/24.JPG">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="images/25.JPG">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="images/26.JPG">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="images/27.JPG">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="images/28.JPG">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="images/29.JPG">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="images/30.JPG">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="images/31.JPG">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="images/32.JPG">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="images/33.JPG">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="images/34.JPG">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="images/35.JPG">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="images/36.JPG">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="images/37.JPG">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="images/38.JPG">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="images/39.JPG">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="images/40.JPG">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="images/41.JPG">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="images/42.JPG">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="images/43.JPG">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="images/44.JPG">
			</div>
		</div>
	</div>
</body>
<script type="text/javascript">
	//瀑布流原理，第二排以及后面的照片，要依次定位在前面一排的最矮的照片后面
	window.onload=function(){
		waterfall();
	}

	function waterfall(){
		var Main=document.getElementById("main");//获取#main
		var Boxs=getByClass(Main,"box");		 //自定义函数获取#main低下class为box
		var bodyWidth=document.body.clientWidth; //获取body宽度
		var BoxWidth=Boxs[0].offsetWidth;		 //获取每个盒子的宽度
		var cols=Math.floor(bodyWidth/BoxWidth); //获取列数
		Main.style.cssText='width:'+BoxWidth*cols+'px;margin:0 auto';//给#main大盒子设置宽度，并让他居中
		var arrH=[];//定义存放每列之前占据的高度
		//遍历每个盒子
		for(var i=0;i<Boxs.length;i++){
			if(i<cols){
				arrH.push(Boxs[i].offsetHeight)//保存第一排的高度
			}else{//第二排开始
				var minH=Math.min.apply(null,arrH);//求出arrH中最小值
				var index=getMinWidth(arrH,minH);  //自定义函数求最小高度对应图片数组的索引
				Boxs[i].style.position='absolute';//给第二排及以下的设置绝对定位
				Boxs[i].style.top=minH+'px';//top为arrH中的最小值
				Boxs[i].style.left=Boxs[index].offsetLeft+'px';//left为对应图片的left值
				arrH[index]+=Boxs[i].offsetHeight;//加入图片后，跟新数组，arrH保存的是每列现有的高度
			}
		}
	}
	//自定义函数 通过class获取元素
	function getByClass(parent,clsName){
		var result=new Array();
		var AllElement=parent.getElementsByTagName("*");
		for(var i=0;i<AllElement.length;i++){
			if(AllElement[i].className==clsName){
				result.push(AllElement[i]);
			}
		}
		return result;
	}

	//自定义函数 获取相应元素索引
	function getMinWidth(Arr,val){
		for(var j=0;j<Arr.length;j++){
			if(Arr[j]==val){
				return j;
			}
		}
	}
</script>
</html>